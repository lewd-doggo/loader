<!DOCTYPE html><html style="height: 99.9%;" lang="en"> <head> <meta charset="utf-8"> <title>crypt-loader</title> </head> <body style="padding: 0; margin: 0; height: 100%;"><iframe style="border: 0; width: 100%; height: 0;"></iframe> <div id="inputs" style="width: 0; overflow: hidden; position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%)"> <input id="path" type="text" placeholder="Path"><br><input id="password" type="password" placeholder="Password"><br><button id="load-btn">Load</button> </div><script id="loader-script" defer> let uint=(new Uint8Array).constructor; let decoder=new TextDecoder('utf8'); let concat=(a, b)=>{let c=new uint(a.length + b.length); c.set(a, 0); c.set(b, a.length); return c;}; let str2ab=(str)=>{const buf=new ArrayBuffer(str.length); const bufView=new Uint8Array(buf); for (let i=0, strLen=str.length; i < strLen; i++){bufView[i]=str.charCodeAt(i);}return buf;}; let key_data; let iv; let meta; let buffer=new uint(); let loaded=()=>{crypto.subtle.importKey( "raw", key_data, "AES-CTR", false, ["decrypt"] ).then(key=>{crypto.subtle.decrypt({name: "AES-CTR", counter: iv, length: 64}, key, buffer ).then(cipher_data=>{let ciphertext=decoder.decode(cipher_data); if(ciphertext.startsWith(meta.s)){document.getElementById('inputs').remove(); document.body.firstChild.style.height="100%"; document.body.firstChild.addEventListener("load", function(){this.contentWindow.meta=meta;}); document.body.firstChild.srcdoc=ciphertext;}});});}; let load=(path, passwd)=>{key_data=passwd.subarray(0, 32); iv=passwd.subarray(32, 48); meta=JSON.parse(decoder.decode(passwd.subarray(48))); fetch(path).then(result=>{let reader=result.body.getReader(); reader.read().then(function read(body){if (body.done) return loaded(); buffer=concat(buffer, body.value); return reader.read().then(read);})});}; let path=window.location.search.substr(1); let password=window.location.hash.substr(1); if(path.length && password.length){load(path, new uint(str2ab(atob(password))));}else{document.getElementById('path').value=path; document.getElementById('password').value=password; document.getElementById('inputs').style.width="max-content"; document.getElementById('load-btn').onclick=()=>{path=document.getElementById('path').value; password=document.getElementById('password').value; if(path.length && password.length){load(path, new uint(str2ab(atob(password))));}};}; document.getElementById('loader-script').remove(); </script> </body></html>
<!--
    http://localhost:8080/crypt-loader.html?vib-single-file-test/index.html.enc#0dUt5FgvT+G8bcsO6aamJfMK43RBJV8tPdMVZJr3T9gIJIZOXsYYK/DADZx7TnxpewoJInMiOiI8Igp9Cg==
-->
